buildscript {
    repositories {
        mavenCentral()
        jcenter()
    }
}

plugins {
    id 'java'
    id "org.jetbrains.kotlin.jvm" version "1.3.61"
    id 'org.jetbrains.intellij' version '0.4.14'
    id 'antlr'
    id 'nebula.lint' version '16.0.2'
    id 'idea'
    id "org.jlleitschuh.gradle.ktlint-idea" version "9.1.1"
}

gradleLint.rules = ['all-dependency', 'archaic-wrapper']

repositories {
    mavenCentral()
    jcenter()
}

group 'com.github.xxx'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

generateGrammarSource {
    arguments += ["-package", "lpc"]
}

dependencies {
    gradleLint.ignore {
        antlr("org.antlr:antlr4:4.7.2")
    }

    compile "org.antlr:antlr4-intellij-adaptor:0.1"
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    version '2019.3'
}

patchPluginXml {
    changeNotes """
      <em>initial release</em>"""
}

compileKotlin.dependsOn generateGrammarSource
compileTestKotlin.dependsOn generateTestGrammarSource

//test {
//    systemProperty "idea.home.path", "/home/mpd/git-sources/intellij-community/"
//}

clean {
    delete "generated-src"
}
